<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Fortran library for Geodesics: geodesic.for File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Fortran library for Geodesics<span id="projectnumber">&#160;1.44</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle"><div class="title">geodesic.for File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Implementation of geodesic routines in Fortran.  
<a href="#details">More...</a></p>

<p><a href="geodesic_8for_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a5c10971e87c8f8082ccdb58e12ae4938"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="geodesic_8for.html#a5c10971e87c8f8082ccdb58e12ae4938">direct</a> (a, f, lat1, lon1, azi1, s12a12, flags, lat2, lon2, azi2, omask, a12s12, m12, MM12, MM21, SS12)</td></tr>
<tr class="memdesc:a5c10971e87c8f8082ccdb58e12ae4938"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solve the direct geodesic problem.  <a href="geodesic_8for.html#a5c10971e87c8f8082ccdb58e12ae4938">More...</a><br /></td></tr>
<tr class="separator:a5c10971e87c8f8082ccdb58e12ae4938"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14ea57c6906c2f6ff5fc02eefff45a10"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="geodesic_8for.html#a14ea57c6906c2f6ff5fc02eefff45a10">invers</a> (a, f, lat1, lon1, lat2, lon2, s12, azi1, azi2, omask, a12, m12, MM12, MM21, SS12)</td></tr>
<tr class="memdesc:a14ea57c6906c2f6ff5fc02eefff45a10"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solve the inverse geodesic problem.  <a href="geodesic_8for.html#a14ea57c6906c2f6ff5fc02eefff45a10">More...</a><br /></td></tr>
<tr class="separator:a14ea57c6906c2f6ff5fc02eefff45a10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d2f95e00315986b3f397f0841e04bd2"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="geodesic_8for.html#a3d2f95e00315986b3f397f0841e04bd2">area</a> (a, f, lats, lons, n, AA, PP)</td></tr>
<tr class="memdesc:a3d2f95e00315986b3f397f0841e04bd2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine the area of a geodesic polygon.  <a href="geodesic_8for.html#a3d2f95e00315986b3f397f0841e04bd2">More...</a><br /></td></tr>
<tr class="separator:a3d2f95e00315986b3f397f0841e04bd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bf5982cdf4c09094ec60e0b6aad291d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="geodesic_8for.html#a6bf5982cdf4c09094ec60e0b6aad291d">geover</a> (major, minor, patch)</td></tr>
<tr class="memdesc:a6bf5982cdf4c09094ec60e0b6aad291d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the version numbers for this package.  <a href="geodesic_8for.html#a6bf5982cdf4c09094ec60e0b6aad291d">More...</a><br /></td></tr>
<tr class="separator:a6bf5982cdf4c09094ec60e0b6aad291d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Implementation of geodesic routines in Fortran. </p>
<p >This is a Fortran implementation of the geodesic algorithms described in</p><ul>
<li>C. F. F. Karney, <a href="https://dx.doi.org/10.1007/s00190-012-0578-z">Algorithms for geodesics</a>, J. Geodesy <b>87</b>, 43&ndash;55 (2013); DOI: <a href="https://dx.doi.org/10.1007/s00190-012-0578-z">10.1007/s00190-012-0578-z</a>; addenda: <a href="http://geographiclib.sf.net/geod-addenda.html">geod-addenda.html</a>.</li>
</ul>
<p>The principal advantages of these algorithms over previous ones (e.g., Vincenty, 1975) are</p><ul>
<li>accurate to round off for |<em>f</em>| &lt; 1/50;</li>
<li>the solution of the inverse problem is always found;</li>
<li>differential and integral properties of geodesics are computed.</li>
</ul>
<p >The shortest path between two points on the ellipsoid at (<em>lat1</em>, <em>lon1</em>) and (<em>lat2</em>, <em>lon2</em>) is called the geodesic. Its length is <em>s12</em> and the geodesic from point 1 to point 2 has forward azimuths <em>azi1</em> and <em>azi2</em> at the two end points.</p>
<p >Traditionally two geodesic problems are considered:</p><ul>
<li>the direct problem &ndash; given <em>lat1</em>, <em>lon1</em>, <em>s12</em>, and <em>azi1</em>, determine <em>lat2</em>, <em>lon2</em>, and <em>azi2</em>. This is solved by the subroutine <a class="el" href="geodesic_8for.html#a5c10971e87c8f8082ccdb58e12ae4938" title="Solve the direct geodesic problem.">direct()</a>.</li>
<li>the inverse problem &ndash; given <em>lat1</em>, <em>lon1</em>, <em>lat2</em>, <em>lon2</em>, determine <em>s12</em>, <em>azi1</em>, and <em>azi2</em>. This is solved by the subroutine <a class="el" href="geodesic_8for.html#a14ea57c6906c2f6ff5fc02eefff45a10" title="Solve the inverse geodesic problem.">invers()</a>.</li>
</ul>
<p >The ellipsoid is specified by its equatorial radius <em>a</em> (typically in meters) and flattening <em>f</em>. The routines are accurate to round off with double precision arithmetic provided that |<em>f</em>| &lt; 1/50; for the WGS84 ellipsoid, the errors are less than 15 nanometers. (Reasonably accurate results are obtained for |<em>f</em>| &lt; 1/5.) For a prolate ellipsoid, specify <em>f</em> &lt; 0.</p>
<p >The routines also calculate several other quantities of interest</p><ul>
<li><em>SS12</em> is the area between the geodesic from point 1 to point 2 and the equator; i.e., it is the area, measured counter-clockwise, of the geodesic quadrilateral with corners (<em>lat1</em>,<em>lon1</em>), (0,<em>lon1</em>), (0,<em>lon2</em>), and (<em>lat2</em>,<em>lon2</em>).</li>
<li><em>m12</em>, the reduced length of the geodesic is defined such that if the initial azimuth is perturbed by <em>dazi1</em> (radians) then the second point is displaced by <em>m12</em> <em>dazi1</em> in the direction perpendicular to the geodesic. On a curved surface the reduced length obeys a symmetry relation, <em>m12</em> + <em>m21</em> = 0. On a flat surface, we have <em>m12</em> = <em>s12</em>.</li>
<li><em>MM12</em> and <em>MM21</em> are geodesic scales. If two geodesics are parallel at point 1 and separated by a small distance <em>dt</em>, then they are separated by a distance <em>MM12</em> <em>dt</em> at point 2. <em>MM21</em> is defined similarly (with the geodesics being parallel to one another at point 2). On a flat surface, we have <em>MM12</em> = <em>MM21</em> = 1.</li>
<li><em>a12</em> is the arc length on the auxiliary sphere. This is a construct for converting the problem to one in spherical trigonometry. <em>a12</em> is measured in degrees. The spherical arc length from one equator crossing to the next is always 180&deg;.</li>
</ul>
<p >If points 1, 2, and 3 lie on a single geodesic, then the following addition rules hold:</p><ul>
<li><em>s13</em> = <em>s12</em> + <em>s23</em> </li>
<li><em>a13</em> = <em>a12</em> + <em>a23</em> </li>
<li><em>SS13</em> = <em>SS12</em> + <em>SS23</em> </li>
<li><em>m13</em> = <em>m12</em> <em>MM23</em> + <em>m23</em> <em>MM21</em> </li>
<li><em>MM13</em> = <em>MM12</em> <em>MM23</em> &minus; (1 &minus; <em>MM12</em> <em>MM21</em>) <em>m23</em> / <em>m12</em> </li>
<li><em>MM31</em> = <em>MM32</em> <em>MM21</em> &minus; (1 &minus; <em>MM23</em> <em>MM32</em>) <em>m12</em> / <em>m23</em> </li>
</ul>
<p >The shortest distance returned by the solution of the inverse problem is (obviously) uniquely defined. However, in a few special cases there are multiple azimuths which yield the same shortest distance. Here is a catalog of those cases:</p><ul>
<li><em>lat1</em> = &minus;<em>lat2</em> (with neither point at a pole). If <em>azi1</em> = <em>azi2</em>, the geodesic is unique. Otherwise there are two geodesics and the second one is obtained by setting [<em>azi1</em>, <em>azi2</em>] = [<em>azi2</em>, <em>azi1</em>], [<em>MM12</em>, <em>MM21</em>] = [<em>MM21</em>, <em>MM12</em>], <em>SS12</em> = &minus;<em>SS12</em>. (This occurs when the longitude difference is near &plusmn;180&deg; for oblate ellipsoids.)</li>
<li><em>lon2</em> = <em>lon1</em> &plusmn; 180&deg; (with neither point at a pole). If <em>azi1</em> = 0&deg; or &plusmn;180&deg;, the geodesic is unique. Otherwise there are two geodesics and the second one is obtained by setting [<em>azi1</em>, <em>azi2</em>] = [&minus;<em>azi1</em>, &minus;<em>azi2</em>], <em>SS12</em> = &minus;<em>SS12</em>. (This occurs when <em>lat2</em> is near &minus;<em>lat1</em> for prolate ellipsoids.)</li>
<li>Points 1 and 2 at opposite poles. There are infinitely many geodesics which can be generated by setting [<em>azi1</em>, <em>azi2</em>] = [<em>azi1</em>, <em>azi2</em>] + [<em>d</em>, &minus;<em>d</em>], for arbitrary <em>d</em>. (For spheres, this prescription applies when points 1 and 2 are antipodal.)</li>
<li><em>s12</em> = 0 (coincident points). There are infinitely many geodesics which can be generated by setting [<em>azi1</em>, <em>azi2</em>] = [<em>azi1</em>, <em>azi2</em>] + [<em>d</em>, <em>d</em>], for arbitrary <em>d</em>.</li>
</ul>
<p >These routines are a simple transcription of the corresponding C++ classes in <a href="http://geographiclib.sf.net">GeographicLib</a>. Because of the limitations of Fortran 77, the classes have been replaced by simple subroutines with no attempt to save "state" across subroutine calls. Most of the internal comments have been retained. However, in the process of transcription some documentation has been lost and the documentation for the C++ classes, <a class="elRef" href="../classGeographicLib_1_1Geodesic.html">GeographicLib::Geodesic</a>, <a class="elRef" href="../classGeographicLib_1_1GeodesicLine.html">GeographicLib::GeodesicLine</a>, and <a class="elRef" href="../classGeographicLib_1_1PolygonAreaT.html">GeographicLib::PolygonAreaT</a>, should be consulted. The C++ code remains the "reference implementation". Think twice about restructuring the internals of the Fortran code since this may make porting fixes from the C++ code more difficult.</p>
<p >Copyright (c) Charles Karney (2012-2015) <a href="#" onclick="location.href='mai'+'lto:'+'cha'+'rl'+'es@'+'ka'+'rne'+'y.'+'com'; return false;">charl<span class="obfuscator">.nosp@m.</span>es@k<span class="obfuscator">.nosp@m.</span>arney<span class="obfuscator">.nosp@m.</span>.com</a> and licensed under the MIT/X11 License. For more information, see <a href="http://geographiclib.sourceforge.net/">http://geographiclib.sourceforge.net/</a></p>
<p >This library was distributed with <a href="../index.html">GeographicLib</a> 1.44. </p>

<p class="definition">Definition in file <a class="el" href="geodesic_8for_source.html">geodesic.for</a>.</p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a5c10971e87c8f8082ccdb58e12ae4938" name="a5c10971e87c8f8082ccdb58e12ae4938"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c10971e87c8f8082ccdb58e12ae4938">&#9670;&nbsp;</a></span>direct()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine <a class="el" href="interfacedirect.html">direct</a> </td>
          <td>(</td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>lat1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>lon1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>azi1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>s12a12</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>lat2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>lon2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>azi2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>omask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>a12s12</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>m12</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>MM12</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>MM21</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>SS12</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Solve the direct geodesic problem. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>the equatorial radius (meters). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">f</td><td>the flattening of the ellipsoid. Setting <em>f</em> = 0 gives a sphere. Negative <em>f</em> gives a prolate ellipsoid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lat1</td><td>latitude of point 1 (degrees). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lon1</td><td>longitude of point 1 (degrees). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">azi1</td><td>azimuth at point 1 (degrees). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">s12a12</td><td>if <em>arcmode</em> is not set, this is the distance between point 1 and point 2 (meters); otherwise it is the arc length between point 1 and point 2 (degrees); it can be negative. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flags</td><td>a bitor'ed combination of the <em>arcmode</em> and <em>unroll</em> flags. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">lat2</td><td>latitude of point 2 (degrees). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">lon2</td><td>longitude of point 2 (degrees). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">azi2</td><td>(forward) azimuth at point 2 (degrees). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">omask</td><td>a bitor'ed combination of mask values specifying which of the following parameters should be set. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">a12s12</td><td>if <em>arcmode</em> is not set, this is the arc length between point 1 and point 2 (degrees); otherwise it is the distance between point 1 and point 2 (meters). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">m12</td><td>reduced length of geodesic (meters). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">MM12</td><td>geodesic scale of point 2 relative to point 1 (dimensionless). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">MM21</td><td>geodesic scale of point 1 relative to point 2 (dimensionless). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">SS12</td><td>area under the geodesic (meters<sup>2</sup>).</td></tr>
  </table>
  </dd>
</dl>
<p><em>flags</em> is an integer in [0, 4) whose binary bits are interpreted as follows</p><ul>
<li>1 the <em>arcmode</em> flag</li>
<li>2 the <em>unroll</em> flag</li>
</ul>
<p>If <em>arcmode</em> is not set, <em>s12a12</em> is <em>s12</em> and <em>a12s12</em> is <em>a12</em>; otherwise, <em>s12a12</em> is <em>a12</em> and <em>a12s12</em> is <em>s12</em>. It <em>unroll</em> is not set, the value <em>lon2</em> returned is in the range [&minus;180&deg;, 180&deg;); if unroll is set, the longitude variable is "unrolled" so that <em>lon2</em> &minus; <em>lon1</em> indicates how many times and in what sense the geodesic encircles the ellipsoid.</p>
<p ><em>omask</em> is an integer in [0, 16) whose binary bits are interpreted as follows</p><ul>
<li>1 return <em>a12</em> </li>
<li>2 return <em>m12</em> </li>
<li>4 return <em>MM12</em> and <em>MM21</em> </li>
<li>8 return <em>SS12</em> </li>
</ul>
<p ><em>lat1</em> should be in the range [&minus;90&deg;, 90&deg;]. The value <em>azi2</em> returned is in the range [&minus;180&deg;, 180&deg;).</p>
<p >If either point is at a pole, the azimuth is defined by keeping the longitude fixed, writing <em>lat</em> = <em>lat</em> = &plusmn;(90&deg; &minus; &epsilon;), and taking the limit &epsilon; &rarr; 0+. An arc length greater that 180&deg; signifies a geodesic which is not a shortest path. (For a prolate ellipsoid, an additional condition is necessary for a shortest path: the longitudinal extent must not exceed of 180&deg;.)</p>
<p >Example of use: </p><div class="fragment"><div class="line"><span class="comment">*&gt; @file geoddirect.for</span></div>
<div class="line"><span class="comment">*! @brief A test program for direct()</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">*&gt; A simple program to solve the direct geodesic problem.</span></div>
<div class="line"><span class="comment">*!</span></div>
<div class="line"><span class="comment">*! This program reads in lines with lat1, lon1, azi1, s12 and prints out</span></div>
<div class="line"><span class="comment">*! lines with lat2, lon2, azi2 (for the WGS84 ellipsoid).</span></div>
<div class="line"> </div>
<div class="line">      <span class="keyword">program</span> <a class="code hl_function" href="geoddirect_8for.html#a343ae8d74783e4830b4917d8c5768e54">geoddirect</a></div>
<div class="line">      <span class="keywordtype">implicit none</span></div>
<div class="line"> </div>
<div class="line">      include <span class="stringliteral">&#39;geodesic.inc&#39;</span></div>
<div class="line"> </div>
<div class="line">      <span class="keywordtype">double precision</span> a, f, lat1, lon1, azi1, lat2, lon2, azi2, s12,</div>
<div class="line">     +    dummy1, dummy2, dummy3, dummy4, dummy5</div>
<div class="line">      <span class="keywordtype">integer</span> flags, omask</div>
<div class="line"> </div>
<div class="line"><span class="comment">* WGS84 values</span></div>
<div class="line">      a = 6378137d0</div>
<div class="line">      f = 1/298.257223563d0</div>
<div class="line"> </div>
<div class="line">      flags = 0</div>
<div class="line">      omask = 0</div>
<div class="line"> </div>
<div class="line"> 10   <span class="keywordflow">continue</span></div>
<div class="line">      <span class="keyword">read</span>(*, *, <span class="keyword">end</span>=90, err=90) lat1, lon1, azi1, s12</div>
<div class="line">      <span class="keywordflow">if</span> (abs(lat1) .gt. 90) <span class="keywordflow">then</span></div>
<div class="line">        print 15</div>
<div class="line"> 15     <span class="keyword">format</span>(1x, <span class="stringliteral">&#39;lat1 must be in [-90,90]&#39;</span>)</div>
<div class="line">        <span class="keywordflow">go to</span> 10</div>
<div class="line"><span class="keywordflow">      end if</span></div>
<div class="line">      <span class="keyword">call </span><a class="code hl_interface" href="interfacedirect.html">direct</a>(a, f, lat1, lon1, azi1, s12, flags,</div>
<div class="line">     +    lat2, lon2, azi2, omask,</div>
<div class="line">     +    dummy1, dummy2, dummy3, dummy4, dummy5)</div>
<div class="line">      print 20, lat2, lon2, azi2</div>
<div class="line"> 20   <span class="keyword">format</span>(1x, f20.15, 1x, f20.15, 1x, f20.15)</div>
<div class="line">      <span class="keywordflow">go to</span> 10</div>
<div class="line"> 90   <span class="keywordflow">continue</span></div>
<div class="line"> </div>
<div class="line">      stop</div>
<div class="line">      <span class="keyword">end</span></div>
<div class="ttc" id="ageoddirect_8for_html_a343ae8d74783e4830b4917d8c5768e54"><div class="ttname"><a href="geoddirect_8for.html#a343ae8d74783e4830b4917d8c5768e54">geoddirect</a></div><div class="ttdeci">program geoddirect</div><div class="ttdoc">A simple program to solve the direct geodesic problem.</div><div class="ttdef"><b>Definition:</b> <a href="geoddirect_8for_source.html#l00009">geoddirect.for:9</a></div></div>
<div class="ttc" id="ainterfacedirect_html"><div class="ttname"><a href="interfacedirect.html">direct</a></div><div class="ttdef"><b>Definition:</b> <a href="geodesic_8inc_source.html#l00012">geodesic.inc:12</a></div></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="geodesic_8for_source.html#l00183">183</a> of file <a class="el" href="geodesic_8for_source.html">geodesic.for</a>.</p>

</div>
</div>
<a id="a14ea57c6906c2f6ff5fc02eefff45a10" name="a14ea57c6906c2f6ff5fc02eefff45a10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14ea57c6906c2f6ff5fc02eefff45a10">&#9670;&nbsp;</a></span>invers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine <a class="el" href="interfaceinvers.html">invers</a> </td>
          <td>(</td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>lat1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>lon1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>lat2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>lon2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>s12</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>azi1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>azi2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>omask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>a12</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>m12</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>MM12</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>MM21</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>SS12</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Solve the inverse geodesic problem. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>the equatorial radius (meters). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">f</td><td>the flattening of the ellipsoid. Setting <em>f</em> = 0 gives a sphere. Negative <em>f</em> gives a prolate ellipsoid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lat1</td><td>latitude of point 1 (degrees). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lon1</td><td>longitude of point 1 (degrees). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lat2</td><td>latitude of point 2 (degrees). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lon2</td><td>longitude of point 2 (degrees). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">s12</td><td>distance between point 1 and point 2 (meters). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">azi1</td><td>azimuth at point 1 (degrees). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">azi2</td><td>(forward) azimuth at point 2 (degrees). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">omask</td><td>a bitor'ed combination of mask values specifying which of the following parameters should be set. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">a12</td><td>arc length of between point 1 and point 2 (degrees). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">m12</td><td>reduced length of geodesic (meters). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">MM12</td><td>geodesic scale of point 2 relative to point 1 (dimensionless). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">MM21</td><td>geodesic scale of point 1 relative to point 2 (dimensionless). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">SS12</td><td>area under the geodesic (meters<sup>2</sup>).</td></tr>
  </table>
  </dd>
</dl>
<p><em>omask</em> is an integer in [0, 16) whose binary bits are interpreted as follows</p><ul>
<li>1 return <em>a12</em> </li>
<li>2 return <em>m12</em> </li>
<li>4 return <em>MM12</em> and <em>MM21</em> </li>
<li>8 return <em>SS12</em> </li>
</ul>
<p ><em>lat1</em> and <em>lat2</em> should be in the range [&minus;90&deg;, 90&deg;]. The values of <em>azi1</em> and <em>azi2</em> returned are in the range [&minus;180&deg;, 180&deg;).</p>
<p >If either point is at a pole, the azimuth is defined by keeping the longitude fixed, writing <em>lat</em> = &plusmn;(90&deg; &minus; &epsilon;), and taking the limit &epsilon; &rarr; 0+.</p>
<p >The solution to the inverse problem is found using Newton's method. If this fails to converge (this is very unlikely in geodetic applications but does occur for very eccentric ellipsoids), then the bisection method is used to refine the solution.</p>
<p >Example of use: </p><div class="fragment"><div class="line"><span class="comment">*&gt; @file geodinverse.for</span></div>
<div class="line"><span class="comment">*! @brief A test program for invers()</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">*&gt; A simple program to solve the inverse geodesic problem.</span></div>
<div class="line"><span class="comment">*!</span></div>
<div class="line"><span class="comment">*! This program reads in lines with lat1, lon1, lon2, lat2 and prints</span></div>
<div class="line"><span class="comment">*! out lines with azi1, azi2, s12 (for the WGS84 ellipsoid).</span></div>
<div class="line"> </div>
<div class="line">      <span class="keyword">program</span> <a class="code hl_function" href="geodinverse_8for.html#a83b1c02c0a50a67416aad2697f7a58d6">geodinverse</a></div>
<div class="line">      <span class="keywordtype">implicit none</span></div>
<div class="line"> </div>
<div class="line">      include <span class="stringliteral">&#39;geodesic.inc&#39;</span></div>
<div class="line"> </div>
<div class="line">      <span class="keywordtype">double precision</span> a, f, lat1, lon1, azi1, lat2, lon2, azi2, s12,</div>
<div class="line">     +    dummy1, dummy2, dummy3, dummy4, dummy5</div>
<div class="line">      <span class="keywordtype">integer</span> omask</div>
<div class="line"> </div>
<div class="line"><span class="comment">* WGS84 values</span></div>
<div class="line">      a = 6378137d0</div>
<div class="line">      f = 1/298.257223563d0</div>
<div class="line"> </div>
<div class="line">      omask = 0</div>
<div class="line"> </div>
<div class="line"> 10   <span class="keywordflow">continue</span></div>
<div class="line">      <span class="keyword">read</span>(*, *, <span class="keyword">end</span>=90, err=90) lat1, lon1, lat2, lon2</div>
<div class="line">      <span class="keywordflow">if</span> (abs(lat1) .gt. 90 .or. abs(lat2) .gt. 90) <span class="keywordflow">then</span></div>
<div class="line">        print 15</div>
<div class="line"> 15     <span class="keyword">format</span>(1x,<span class="stringliteral">&#39;lat1 and lat2 must be in [-90,90]&#39;</span>)</div>
<div class="line">        <span class="keywordflow">go to</span> 10</div>
<div class="line"><span class="keywordflow">      end if</span></div>
<div class="line">      <span class="keyword">call </span><a class="code hl_interface" href="interfaceinvers.html">invers</a>(a, f, lat1, lon1, lat2, lon2,</div>
<div class="line">     +    s12, azi1, azi2, omask,</div>
<div class="line">     +    dummy1, dummy2, dummy3, dummy4 , dummy5)</div>
<div class="line">      print 20, azi1, azi2, s12</div>
<div class="line"> 20   <span class="keyword">format</span>(1x, f20.15, 1x, f20.15, 1x, f19.10)</div>
<div class="line">      <span class="keywordflow">go to</span> 10</div>
<div class="line"> 90   <span class="keywordflow">continue</span></div>
<div class="line"> </div>
<div class="line">      stop</div>
<div class="line">      <span class="keyword">end</span></div>
<div class="ttc" id="ageodinverse_8for_html_a83b1c02c0a50a67416aad2697f7a58d6"><div class="ttname"><a href="geodinverse_8for.html#a83b1c02c0a50a67416aad2697f7a58d6">geodinverse</a></div><div class="ttdeci">program geodinverse</div><div class="ttdoc">A simple program to solve the inverse geodesic problem.</div><div class="ttdef"><b>Definition:</b> <a href="geodinverse_8for_source.html#l00009">geodinverse.for:9</a></div></div>
<div class="ttc" id="ainterfaceinvers_html"><div class="ttname"><a href="interfaceinvers.html">invers</a></div><div class="ttdef"><b>Definition:</b> <a href="geodesic_8inc_source.html#l00020">geodesic.inc:20</a></div></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="geodesic_8for_source.html#l00522">522</a> of file <a class="el" href="geodesic_8for_source.html">geodesic.for</a>.</p>

</div>
</div>
<a id="a3d2f95e00315986b3f397f0841e04bd2" name="a3d2f95e00315986b3f397f0841e04bd2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d2f95e00315986b3f397f0841e04bd2">&#9670;&nbsp;</a></span>area()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine <a class="el" href="interfacearea.html">area</a> </td>
          <td>(</td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(n)&#160;</td>
          <td class="paramname"><em>lats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(n)&#160;</td>
          <td class="paramname"><em>lons</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>AA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>PP</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determine the area of a geodesic polygon. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>the equatorial radius (meters). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">f</td><td>the flattening of the ellipsoid. Setting <em>f</em> = 0 gives a sphere. Negative <em>f</em> gives a prolate ellipsoid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lats</td><td>an array of the latitudes of the vertices (degrees). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lons</td><td>an array of the longitudes of the vertices (degrees). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>the number of vertices. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">AA</td><td>the (signed) area of the polygon (meters<sup>2</sup>). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">PP</td><td>the perimeter of the polygon.</td></tr>
  </table>
  </dd>
</dl>
<p><em>lats</em> should be in the range [&minus;90&deg;, 90&deg;].</p>
<p >Only simple polygons (which are not self-intersecting) are allowed. There's no need to "close" the polygon by repeating the first vertex. The area returned is signed with counter-clockwise traversal being treated as positive. </p>

<p class="definition">Definition at line <a class="el" href="geodesic_8for_source.html#l00945">945</a> of file <a class="el" href="geodesic_8for_source.html">geodesic.for</a>.</p>

</div>
</div>
<a id="a6bf5982cdf4c09094ec60e0b6aad291d" name="a6bf5982cdf4c09094ec60e0b6aad291d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6bf5982cdf4c09094ec60e0b6aad291d">&#9670;&nbsp;</a></span>geover()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine <a class="el" href="interfacegeover.html">geover</a> </td>
          <td>(</td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>major</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>minor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>patch</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the version numbers for this package. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">major</td><td>the major version number. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">minor</td><td>the minor version number. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">patch</td><td>the patch number.</td></tr>
  </table>
  </dd>
</dl>
<p>This subroutine was added with version 1.44. </p>

<p class="definition">Definition at line <a class="el" href="geodesic_8for_source.html#l01011">1011</a> of file <a class="el" href="geodesic_8for_source.html">geodesic.for</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
